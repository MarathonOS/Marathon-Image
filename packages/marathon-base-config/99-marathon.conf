# Marathon OS System Tuning
# Memory management optimized for zram and low-latency

# zram-friendly behavior
vm.swappiness = 100
vm.page-cluster = 0
vm.watermark_scale_factor = 125
vm.watermark_boost_factor = 0

# flash writeback (F2FS + ext4 on eMMC/UFS)
vm.dirty_ratio = 10
vm.dirty_background_ratio = 5
vm.dirty_writeback_centisecs = 1500

# cache tuning
vm.vfs_cache_pressure = 50

# Memory compaction for better performance
vm.compact_unevictable_allowed = 1
vm.compaction_proactiveness = 20

# OOM killer tuning
vm.oom_kill_allocating_task = 0
vm.overcommit_memory = 1
vm.overcommit_ratio = 50

# Network performance
net.core.netdev_max_backlog = 16384
net.ipv4.tcp_fastopen = 3
net.ipv4.tcp_congestion_control = bbr

# Additional TCP optimizations
net.ipv4.tcp_window_scaling = 1
net.ipv4.tcp_timestamps = 1
net.ipv4.tcp_sack = 1
net.ipv4.tcp_fack = 1
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_rmem = 4096 87380 16777216
net.ipv4.tcp_wmem = 4096 65536 16777216
net.ipv4.tcp_mtu_probing = 1

# UDP optimizations
net.core.rmem_default = 262144
net.core.wmem_default = 262144

# Reduce latency for interactive workloads
kernel.sched_latency_ns = 6000000
kernel.sched_min_granularity_ns = 2000000
kernel.sched_wakeup_granularity_ns = 3000000


